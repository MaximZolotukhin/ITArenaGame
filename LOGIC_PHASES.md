# Логика фаз раунда (ЭТАП 2)

## Как устроен переход между фазами

1. **Сверяемся с массивом фаз** — в раунде столько фаз, сколько элементов в `getRoundPhases()` (фазы будут расширяться).
2. **Считываем текущую фазу** — по `current_phase_index` (0, 1, 2, …).
3. **Выполняем логику фазы** — ждём команды «все игроки закончили ход» (для event — `players_left_in_round <= 0`, для skills и др. — `players_completed_current_phase >= N`).
4. **Смотрим в массив фаз** — есть ли следующая фаза (`current_phase_index + 1 < numberOfPhases`)?
   - **Если да** — загружаем следующую фазу (переход по `transition` из массива), первый игрок входит в неё.
   - **Если нет** — переход к следующему раунду: сбрасываем счётчик фаз (`current_phase_index = 0`), увеличиваем раунд, повторяем цикл.
5. Цикл повторяется до последнего раунда (потом переход в EndScore).

## Массив фаз

В `Game::getRoundPhases()` задаётся порядок фаз раунда. У каждой фазы:

| Поле        | Описание |
|------------|----------|
| key        | Ключ фазы (event, skills, …) |
| name       | Название для отображения |
| number     | Номер в раунде (1, 2, 3…) |
| state      | Класс состояния (RoundEvent, RoundSkills, …) |
| transition | Имя перехода из NextPlayer в это состояние (toRoundEvent, toRoundSkills, …) |

Сейчас в массиве 2 фазы: **Событие** (event), **Навыки** (skills). Добавление новой фазы = новый элемент в массиве с своим `state` и `transition`.

## Переменные состояния

- **round_number** — текущий раунд (1, 2, …).
- **current_phase_index** — индекс текущей фазы в массиве фаз. При переходе на новый раунд сбрасывается в 0.
- **players_left_in_round** — сколько игроков ещё должны сделать ход в фазе «Событие» (ходы в event).
- **players_completed_current_phase** — сколько игроков закончили ход в текущей фазе (для skills и будущих фаз).

## Фаза «Событие» (event)

- Первый игрок → остальные → последний (здесь потом: штрафы, логика кости).
- Завершение фазы: `players_left_in_round <= 0`.
- После завершения: смотрим массив фаз → есть следующая фаза? Загружаем её. Нет → следующий раунд.

## Фаза «Навыки» (skills) и остальные фазы

- Выполняем логику фазы, ждём «все игроки закончили ход» (`players_completed_current_phase >= N`).
- После завершения: смотрим массив фаз → есть следующая фаза? Загружаем её. Нет → следующий раунд (сброс счётчика фаз, round_number++, и т.д.).
